<!DOCTYPE html><p><script>let n={};let o=0;function e(t){let i=n.o;t*=.001;o=t,i.clear(i.COLOR_BUFFER_BIT),i.bindBuffer(i.ARRAY_BUFFER,n.t),i.vertexAttribPointer(n.i,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(n.i),i.useProgram(n.s),i.drawArrays(i.TRIANGLE_STRIP,0,4),requestAnimationFrame(e)}window.onload=function(){const o=document.createElement("canvas");let a=o.getContext("webgl");n.o=a,o.width=800,o.height=600,n.o.viewport(0,0,n.o.canvas.width,n.o.canvas.height),document.body.appendChild(o),a.clearColor(0,1,0,1);var c=function(n,o,e){const t=r(n,n.VERTEX_SHADER,o),i=r(n,n.FRAGMENT_SHADER,e),a=n.createProgram();n.attachShader(a,t),n.attachShader(a,i),n.linkProgram(a),!1;return a}(a,t,i);n.i=a.getAttribLocation(c,"aVertexPosition"),n.v=a.getUniformLocation(c,"uProjectionMatrix"),n.l=a.getUniformLocation(c,"uModelViewMatrix"),n.s=c,function(o){const e=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,e),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),o.STATIC_DRAW),n.t=e}(a),requestAnimationFrame(e)};const t="\n  attribute vec4 aVertexPosition;\n\n  uniform mat4 uModelViewMatrix;\n  uniform mat4 uProjectionMatrix;\n\n  varying vec2 vUvs;\n\n  void main() {\n    vUvs = (aVertexPosition.xy+vec2(1.0))*0.5;\n    gl_Position = vec4(aVertexPosition.xy,0.0,1.0);\n  }\n",i="\nprecision mediump float;\nvarying vec2 vUvs;\n\nfloat plane(vec3 pos)\n{\n    return dot(pos,vec3(0.0,0.0,1.0))-5.0;\n}\n\nfloat sdBox( vec3 p, vec3 b )\n{\n  vec3 d = abs(p) - b;\n  return length(max(d,0.0))\n         + min(max(d.x,max(d.y,d.z)),0.0); // remove this line for an only partially signed sdf \n}\n\nfloat room(vec3 pos)\n{\n    float d = 1e10;\n    return min(d,sdBox(pos,vec3(0.5)));\n}\n\nvoid main() {\n    const float sensorSize = 3.0;\n    vec3 col = vec3(0.0);\n    float t = 0.1;\n    for( int i=0; i<64; i++ )\n    {\n        vec3 p = vec3(sensorSize*(vUvs*2.0-1.0),0.0)+vec3(0.0,0.0,-1.0)*t;\n        float h = room(p);\n        if( abs(h)<0.001 || t>10.0 ) break;\n        t += h;\n    }\n\n    if( t<10.0 )\n    {\n        col = vec3(0.5);\n    }\n\n    gl_FragColor = vec4(col.xyz, 1.0);\n}\n";function r(n,o,e){const t=n.createShader(o);return n.shaderSource(t,e),n.compileShader(t),t}</script>
