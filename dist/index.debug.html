<!DOCTYPE html><head><title>Debug</title></head><p><script>let e={};let t=0,n=[0,1,3],o=[0,0,-1];function v(r){let y=e.t;const w=(r*=.001)-t;if(t=r,y.clear(y.COLOR_BUFFER_BIT),y.bindBuffer(y.ARRAY_BUFFER,e.o),y.vertexAttribPointer(e.v,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(e.v),y.useProgram(e.i),l=h,x=g,h=0,g=0,0!=l){let e=function(e,t,n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const o=Math.cos(t),v=Math.sin(t),r=1-o;return n[0]=o+e[0]*e[0]*r,n[1]=e[0]*e[1]*r+e[2]*v,n[2]=e[0]*e[2]*r-e[1]*v,n[4]=e[0]*e[1]*r-e[2]*v,n[5]=o+e[1]*e[1]*r,n[6]=e[1]*e[2]*r+e[0]*v,n[8]=e[0]*e[2]*r+e[1]*v,n[9]=e[1]*e[2]*r-e[0]*v,n[10]=o+e[2]*e[2]*r,n}([0,1,0],w*-l);o=m(o=function(e,t,n,o=[0,0,0]){let v=[...t,n];for(let t=0;t<3;t++){o[t]=0;for(let n=0;n<4;n++)o[t]+=e[4*n+t]*v[n]}return o}(e,o,0))}let M=a(o,w),p=u(o,[0,1,0]);p=a(m(p),w),b(s)&&(n=c(n,M,n)),b(z)&&(n=i(n,M,n)),b(d)&&(n=i(n,p,n)),b(V)&&(n=c(n,p,n));let P=function(e,t,n,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){let v=m(i(t,e)),r=m(u(v,n)),c=u(r,v);return o[0]=r[0],o[4]=r[1],o[8]=r[2],o[1]=c[0],o[5]=c[1],o[9]=c[2],o[2]=-v[0],o[6]=-v[1],o[10]=-v[2],o[12]=-f(r,e),o[13]=-f(c,e),o[14]=f(v,e),o}(n,c(n,o),[0,1,0]),k=function(e,t,n,o,v,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){const c=Math.cos(.5*e)/Math.sin(.5*e),i=c*n/t;return r[0]=i,r[5]=c,r[10]=-(v+o)/(v-o),r[11]=-1,r[14]=-2*v*o/(v-o),r}(.5*Math.PI,e.t.canvas.height,e.t.canvas.width,.1,100);y.uniformMatrix4fv(e.m,!1,P),y.uniformMatrix4fv(e.u,!1,k),y.drawArrays(y.TRIANGLE_STRIP,0,4),requestAnimationFrame(v)}function r(e,t,n){const o=e.createShader(t);return e.shaderSource(o,n),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)?o:(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(o)),e.deleteShader(o),null)}function c(e,t,n=[0,0,0]){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function i(e,t,n=[0,0,0]){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function a(e,t,n=[0,0,0]){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function f(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function m(e,t=[0,0,0]){let n=function(e){return Math.sqrt(f(e,e))}(e);return t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n,t}function u(e,t,n=[0,0,0]){return n[0]=e[1]*t[2]-e[2]*t[1],n[1]=e[2]*t[0]-e[0]*t[2],n[2]=e[0]*t[1]-e[1]*t[0],n}window.onload=function(){console.log("js12k2019 - Debug mode [ON]");const t=document.createElement("canvas");let n=t.getContext("webgl");e.t=n,t.width=800,t.height=600,e.t.viewport(0,0,e.t.canvas.width,e.t.canvas.height),document.body.appendChild(t),n.clearColor(0,1,0,1);var o=function(e,t,n){const o=r(e,e.VERTEX_SHADER,t),v=r(e,e.FRAGMENT_SHADER,n),c=e.createProgram();if(e.attachShader(c,o),e.attachShader(c,v),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))return alert("Unable to initialize the shader program: "+e.getProgramInfoLog(c)),null;return c}(n,k,A);e.v=n.getAttribLocation(o,"aVertexPosition"),e.u=n.getUniformLocation(o,"uProjectionMatrix"),e.m=n.getUniformLocation(o,"uModelViewMatrix"),e.i=o,function(t){const n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,1,1,-1]),t.STATIC_DRAW),e.o=n}(n),document.body.addEventListener("keydown",w,!1),document.body.addEventListener("keyup",M,!1),document.addEventListener("pointerlockchange",P,!1),document.addEventListener("mozpointerlockchange",P,!1),t.addEventListener("click",()=>(function(){let t=e.t.canvas;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock,t.requestPointerLock()})(),!1),requestAnimationFrame(v)};let l,x,y={},s="KeyW",z="KeyS",d="KeyA",V="KeyD",h=0,g=0;function w(e){y[e.code]=!0}function M(e){y[e.code]=!1}function p(e){e.movementX&&(h+=e.movementX),e.movementY&&(g+=e.movementY)}function P(){document.pointerLockElement===e.t.canvas||document.mozPointerLockElement===e.t.canvas?(console.log("Pointer Lock On"),document.addEventListener("mousemove",p,!1)):(console.log("Pointer Lock Off"),document.removeEventListener("mousemove",p,!1))}function b(e){return!!y[e]}let k="precision highp float;\nattribute vec4 aVertexPosition;uniform mat4 uProjectionMatrix;varying vec2 vUvs;varying vec4 vViewVector;mat4 v(mat4 v){return mat4(v[0][0],v[1][0],v[2][0],0.,v[0][1],v[1][1],v[2][1],0.,v[0][2],v[1][2],v[2][2],0.,-dot(v[0].xyz,v[3].xyz),-dot(v[1].xyz,v[3].xyz),-dot(v[2].xyz,v[3].xyz),1.);}void main(){vUvs=(aVertexPosition.xy+vec2(1.))*.5,vViewVector=v(uProjectionMatrix)*vec4(aVertexPosition.xy,1.,1.),vViewVector/=vViewVector.w,gl_Position=vec4(aVertexPosition.xy,0.,1.);}",A="precision highp float;\nvarying vec2 vUvs;varying vec4 vViewVector;uniform mat4 uModelViewMatrix;float v(vec3 v,vec3 f){return dot(v,f);}float f(vec3 v,vec3 m){vec3 f=abs(v)-m;return length(max(f,0.))+min(max(f.x,max(f.y,f.z)),0.);}float f(vec3 v,vec3 m,float f){vec3 y=abs(v)-m;return length(max(y,0.))-f+min(max(y.x,max(y.y,y.z)),0.);}float x(float v,float f){return max(v,f);}vec3 m(vec3 v,vec3 f){return mod(v,f)-.5*f;}float m(float v,float m,float f){float y=clamp(.5+.5*(m-v)/f,0.,1.);return mix(m,v,y)-f*y*(1.-y);}const vec3 y=vec3(.3,.13,.03);float f(vec3 v){const float x=.95;vec3 z=m(v,vec3(y.xy*4.,0.));return f(z,y*vec3(.8*x,.5*x,1.),.05);}float m(vec3 v){return min(f(v),f(v-vec3(y.x*2.,0.,0.)));}float v(vec3 z){float i=v(z,vec3(0.,0.,1.)),r=min(m(z),m(z-vec3(y.x,y.y*2.,0.)));return x(m(i,r,.05),f(z,vec3(1.,1.,1.)));}vec2 x(vec3 f){return vec2(v(f),-1.);}vec3 n(in vec3 v){const float f=.0001;vec2 m=vec2(1.,-1.)*.5773;return normalize(m.xyy*x(v+m.xyy*f).x+m.yyx*x(v+m.yyx*f).x+m.yxy*x(v+m.yxy*f).x+m.xxx*x(v+m.xxx*f).x);}mat4 t(mat4 v){return mat4(v[0][0],v[1][0],v[2][0],0.,v[0][1],v[1][1],v[2][1],0.,v[0][2],v[1][2],v[2][2],0.,-dot(v[0].xyz,v[3].xyz),-dot(v[1].xyz,v[3].xyz),-dot(v[2].xyz,v[3].xyz),1.);}float f(vec3 v,vec3 m,float f,float z){float y=1.,r=f;for(int i=0;i<32;i++){float n=x(v+m*r).x;y=min(y,10.*n/r);r+=n;if(abs(n)<.001||r>z)break;}return step(.01,y);}void main(){const float v=3.;vec3 m=vec3(0.),y;vec2 i;float r=.1;mat4 z=t(uModelViewMatrix);vec3 a=normalize(vViewVector.xyz);for(int l=0;l<64;l++){y=a*r;y=vec3(z*vec4(y,1.));i=x(y);float u=i.x;if(abs(u)<.001||r>20.)break;r+=u;}if(r<20.){vec3 u=normalize(vec3(1.,1.,1.));if(i.y>0.)m=vec3(1.,0.,0.);else m=vec3(.6);vec3 l=n(y);float e=1.;e*=max(0.,dot(u,l));e*=f(y,u,.05,20.);m*=min(1.,.4+e);}gl_FragColor=vec4(m.xyz,1.);}";</script>
